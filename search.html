<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search</title>
    <!--font awesome cdn link-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <!-- custom csss file link-->
    <link rel="stylesheet" href="../css/food.css">
    <link rel="shortcut icon" href="../img/12.png" type="image/x-icon">
</head>
<body>
    <!----HEADER SECTION START-->
    <header>
        <a href="#" class="logo"><i class="fas fa-utensils"></i>Taste haven</a>
        <nav class="navbar">
            <a href="food.html">Home</a>
            <a href="Menu.html">Menu</a>
            <a href="Order.html">Order</a>
            <a href="Reservation.html">Reservation</a>
            <a href="About.html">About</a>
            <a href="Recipes.html">Recipes</a>
            <a href="Contact.html">Contact us</a>
        </nav>
        <div class="icons">
            <i class="fas fa-bars" id="menu-bars"></i>
            <i class="fas fa-search" id="search-icon"></i>
            <div id="userMenu" style="position:relative">
                <!-- User icon -->
                <a href="javascript:void(0)" id="userIcon" class="user-icon fas fa-user"></a>
                <!-- Dropdown -->
                <div id="userDropdown"
                    style="display:none; position:absolute; top:100%; right:0; background:#fff; border:1px solid #ccc; padding:10px; min-width:150px; z-index:100;">
                    <p id="fullNameDisplay"></p>
                    <button id="logoutBtn" class="btn">Logout</button>
                </div>
            </div>
        </div>
    </header>
<!-- SEARCH  -->
<form id="search-form" onsubmit="return searchFood()">
    <input type="search" id="search-box" placeholder="Search Here...">
    <button type="submit"><i class="fas fa-search"></i></button>
</form>
<!-- SEARCH RESULTS -->
<section class="menu" id="searchResults">
    <div class="box-container" id="resultsContainer" style=" margin-top: 6rem;
        margin-bottom: 4rem;"></div>
</section>
    <!--footer section-->
    <footer class="footer">
        <div class="box-containers">
            <div class="box">
                <h2>quick links</h2>
                <a href="food.html">Home</a>
                <a href="Menu.html">Menu</a>
                <a href="Order.html">Order</a>
                <a href="Reservation.html">Reservation</a>
                <a href="About.html">About</a>
                <a href="Recipes.html">Recipes</a>
                <a href="Contact.html">Contact us</a>
            </div>
            <div class="box">
                <h2>contact info</h2>
                <a href="tel:+032-450-51065">+032-450-51065</a>
                <a href="tel:+03278736385">+032-787-36385</a>
                <a href="mailto:ummequean123@gmail.com">ummequean123@gmail.com</a>
                <a href="mailto:dua7214@gmail.com">dua47214@gmail.com</a>
                <a href="mailto:konwalkonwalbashir@gmail.com">konwalkonwalbashir@gmail.com</a>
            </div>
            <div class="box">
                <h2>opening hours</h2>
                <i href="#">Every day</i>
                <i href="#">10:00Am - 12:00Pm</i>
                <i href="#">location</i>
                <i href="#">Garjah,Gujranwala</i>
            </div>
            <div class="box">
                <h2>follow us</h2>
                <a href="https://www.facebook.com">facebook</a>
                <a href="https://www.facebook.com">twitter</a>
                <a href="https://www.facebook.com">instagram</a>
                <a href="https:/a/www.facebook.com">linkedIn</a>
            </div>
        </div>
        <div class="credit">copyright @ 2025 by <span>HDK</span></div>
    </footer>
    <script>
        const API_URL = "http://localhost:8080/api/category";
            const resultsContainer = document.getElementById("resultsContainer");
            const searchBox = document.getElementById("search-box");

            let allDishes = [];

            // Fetch all dishes
            async function fetchDishes() {
                try {
                    const res = await fetch(API_URL);
                    if (!res.ok) throw new Error("Failed to fetch dishes");
                    allDishes = await res.json();

                    // Check if query exists in URL
                    const params = new URLSearchParams(window.location.search);
                    const query = params.get("q") ? params.get("q").toLowerCase() : "";

                    displayResults(allDishes.filter(d => d.name.toLowerCase().includes(query)));
                    if (query) searchBox.value = query; // show query in input
                } catch (err) {
                    console.error(err);
                    resultsContainer.innerHTML = "<p>Unable to load dishes.</p>";
                }
            }

            // Display results
            function displayResults(dishes) {
                resultsContainer.innerHTML = "";
                if (!dishes.length) {
                    resultsContainer.innerHTML = "<p>No dishes found.</p>";
                    return;
                }

                dishes.forEach(d => {
                    const box = document.createElement("div");
                    box.className = "box";
                    box.innerHTML = `
            <a href="detail.html?id=${d._id}">
                <div class="image">
                    <img src="${d.img || '../img/placeholder.png'}" alt="${d.name}">
                    <h3>${d.name}</h3>
                    <span class="price">Rs.${d.price}</span>
                </div>
            </a>
        `;
                    resultsContainer.appendChild(box);
                });
            }

            // Live search while typing
            searchBox.addEventListener("input", () => {
                const query = searchBox.value.trim().toLowerCase();
                const filtered = allDishes.filter(d => d.name.toLowerCase().includes(query));
                displayResults(filtered);
            });

            // Initial fetch
            document.addEventListener("DOMContentLoaded", fetchDishes);
  </script>
    <script src="../script/food.js"></script>
    </body>
    </html>